---
marp: true
theme: default
size: 16:9
paginate: true
---

# 軟體開發中的協作
## Collaboration in Development

Reviewer: Alessio Salvadorini

---

# 協作的重要性與達成手段

- **協作至關重要**
    - 發揮多樣化技能
    - 鼓勵創新
- **有效溝通是關鍵**
    - 尤其在遠距或多元文化團隊
    - 使用數位平台 (會議、文件)

---

# 達成協作的手段 (續) 與 本章重點

- **工具**:
    - 版本控制系統 (Git)
    - 專案管理工具
- **方法論**:
    - Agile (適應性規劃、持續回饋)
    - DevOps (開發與維運結合、共享責任)
- 讓團隊選擇工具很重要！
- **本章重點**:
    - 版本控制 (Version Control)
    - DevOps 心態 (DevOps Mindset)
    - 程式碼審查 (Code Review)

---

# 14.1 版本控制 Essentials

- **版本控制系統 (VCS)** 至關重要
    - 所有軟體專案都在使用
- 主要兩種類型：
    - **集中式 (CVCS)**
    - **分散式 (DVCS)**

---

# 集中式版本控制 (CVCS)

- **範例**: Subversion (SVN)
- 所有檔案與歷史存於**單一中央儲存庫**
- 開發者需連線才能修改
- **缺點**: 中央儲存庫無法使用時，開發停擺

<!-- 原文圖 14.1 CVCS vs DVCS 應在此 -->

---

# 分散式版本控制 (DVCS)

- **範例**: Git, Mercurial, Bitbucket
- 更具彈性
- **每位開發者都有完整的本地儲存庫副本**
- 可獨立工作，甚至離線
- 中央儲存庫僅是慣例
- **優點**: 中央儲存庫故障不影響工作

---

# DVCS (Git) 主流趨勢

- DVCS (尤其是 **Git**) 是現代軟體產業的主流
- **平台**: GitHub, GitLab
    - 建基於 Git
    - 提供整合協作工具 (Issue tracking, Code review, CI)

---

# 14.1.1 程式碼整合策略

- 管理程式碼變更的整合與部署是關鍵
- 兩種廣泛使用的方法：
    - **主幹開發 (Trunk-Based Development, TBD)**
    - **功能分支開發 (Feature-Based Development, FBD)**

---

# 功能分支開發 (FBD)

- 為每個新功能、修復建立**獨立分支**
- `main` 分支保持穩定
- 完成並測試後合併回 `main` (通常經 Code Review)
- **GitFlow** 是一個結構化的 FBD 模型
    - 定義特定分支類型 (`feature`, `release`, `develop`, `hotfix`)

<!-- 原文圖 14.3 Feature-Based Development - Gitflow Model 應在此 -->

---

# 主幹開發 (TBD)

- 開發者**直接在主分支 (`trunk` 或 `main`) 上工作**
- 強調持續整合與快速迭代
- 頻繁提交**小型、增量變更**
- 功能分支 (若有) 生命週期短，盡快合併回主幹

<!-- 原文圖 14.2 Truck Based Development 應在此 -->

---

# TBD vs FBD 比較 (摘要)

| 特點           | TBD           | FBD           |
| :------------- | :------------ | :------------ |
| 整合頻率       | 頻繁          | 較不頻繁      |
| 程式碼隔離       | 有限          | 較高          |
| 分支管理       | 較簡單        | 較複雜        |
| 衝突風險       | 較低          | 較高          |
| 適用於頻繁發布 | 非常適用      | 適用          |
| 合併衝突       | 較少發生      | 頻繁發生      |

---

# 14.1.2 TBD 與 Git 分支

- 本書偏好 **TBD**
    - 適合持續交付 (CI/CD) 文化
    - 減少合併衝突
    - 改善團隊協作
- 許多大公司採用此方法

---

# TBD: 錯誤修復與發布管理

- **錯誤修復**:
    - 直接在 `trunk` 修復
    - 快速整合
    - 發布分支的修復：先回 `trunk`，再 Cherry-pick 到發布分支
- **發布管理**:
    - 低頻率發布：為每個次要版本建發布分支
    - 高頻率發布：直接從 `trunk` 發布 (使用 Commit ID)

---

# TBD: 功能旗標 (Feature Flags)

- 強大技術
- 將**未完成**或**實驗性**功能合併到 `trunk`
- **不對終端用戶暴露**
- 控制功能的可見性與啟用
- 用於 A/B 測試、長期功能開發
- 可切換旗標管理生產環境中的活躍功能

---

# TBD: 程式碼審查與 CI/CD

- **程式碼審查**在 TBD 中至關重要
    - 維護程式碼品質與一致性
    - 因變更小而頻繁，審查更集中、易管理
    - 促進快速、有效率的審查
- TBD 非常**適合 CI/CD**
    - 減少衝突
    - 每天合併小量變更到單一事實來源 (`main`)

---

# 14.2 擁抱 CI/CD

- **CI/CD**: 持續整合 / 持續交付
    - 自動化 構建(Building), 測試(Testing), 部署(Deploying)
    - 目標：減少發布新功能的時間與精力
- 在 Flutter 開發中整合 CI/CD：
    - 顯著提升團隊協作與效率
    - 自動化關鍵開發流程
    - 促進更協作、更緊密的環境

---

# 持續整合 (CI) 在 Flutter 開發中

- **CI**: 每天多次將多位開發者的變更合併到中央儲存庫
    - 有助於早期發現並修復問題
- 在 Flutter 團隊中的作用：
    - 每次提交都觸發自動測試 (單元、元件、整合測試)
    - 開發者獲得**立即回饋**
    - 維護**共享程式碼庫的穩定性與完整性** (對協作至關重要)
- **工具**: Jenkins, GitHub Actions

---

# 持續交付 (CD) 在 Flutter 發布中

- **CD**: 自動將程式碼變更部署到目標環境 (測試、生產)
    - 確保程式碼變更快速提供給測試者或用戶
- 在 Flutter 團隊中的作用：
    - 自動部署到不同環境
    - **減少手動流程** (最小化人為錯誤)
    - 提升團隊協調 (所有成員都能訪問最新構建)
- **平台**: Codemagic (特別支援 Flutter)

---

# CI/CD 在 Flutter 開發 - 總結

<!-- 原文圖 14.4 CD/CI in Flutter Development 應在此 -->

- 透過 CI/CD，Flutter 團隊能達到：
    - 更高效率
    - 更強協作
    - 培養**持續改進**和**共享責任**的文化

---

# 14.3 有效的程式碼審查

- **程式碼審查**是高品質開發的基石
    - 確保程式碼品質與標準
    - 促進協作環境
    - 早期發現 Bug
    - 共享知識
    - 維持一致的開發方法
- 遵循 "Shifting left" 原則 (提早發現問題)

---

# 程式碼審查的重點

- 設計是否適當 (符合架構，如狀態管理)
- 功能性與 Bug 檢查 (如跨裝置渲染)
- 效率 (無冗餘/性能問題，如 JSON 解析是否用 isolate)
- 可讀性與可維護性 (API 設計, 文件, 測試覆蓋度)
- 安全性實踐 (如處理用戶數據)
- 與專案標準的一致性 (架構, 命名, 檔案結構)

---

# 程式碼審查流程：速度與評論

- **審查速度**:
    - 目標一天內完成 (避免瓶頸)
    - 策略性安排時間 (避免中斷工作流程，如午餐後)
- **撰寫有效評論**至關重要
    - 指導開發者改進程式碼
    - 維持建設性與協作氛圍

---

# 撰寫有效評論 (Part 1)

- **具體且善意**: 提建議而非單純指出錯誤 (如建議拆分複雜函數)
- **清晰且具建設性**: 建議可能的改進方法 (如用不同 Flutter 元件優化)
- **鼓勵最佳實踐**: 指導使用 Dart 異步特性 (Future, async-await)
- **解釋原因**: 說明建議的理由 (如為何用 ListView.builder)

---

# 撰寫有效評論 (Part 2)

- 使用 "**Nitpick**" 標記次要問題
- **關注程式碼，而非開發者**
- **提問**以鼓勵開發者思考
- **讚美**好的工作 (如優化複雜邏輯)
- 提供**背景知識**或教學 (如新 Flutter 功能或更好的處理方式)
- 保持**尊重與同理心** (理解寫程式碼投入的心力)

---

# 處理異議與程式碼走查

- **處理異議**:
    - 對話與妥協 (討論替代方案，如狀態管理方法)
    - 聚焦**目標** (程式碼品質/標準，非個人偏好)
- **替代方案**: **程式碼走查 (Code walk-through)**
    - 適用於非同步工作非必須、文化差異大時
    - 作者在視訊通話中帶領審查 (互動性強，降低認知負擔，解釋隱性假設)
    - 審查者仍可審查 PR 細節

---

# 讓程式碼審查變得更好

- 鼓勵**持續學習**文化 (分享新 Dart/Flutter 特性洞見)
- 優先**迭代進步**而非完美 (專注重大功能/可維護性改進)
- **正向鼓勵** (讚美好程式碼和開發者的進步)
- 依**情境調整**審查方法 (考量經驗、複雜度、專案影響)
- 鼓勵開發者對**審查流程提供回饋** (創造更協作動態的文化)
- 審查是雙向學習的獨特機會

---

# 14.4 結論

- 重申**團隊合作**與**協作實踐**的重要性
    - 集體努力與個人貢獻同等重要
    - 程式碼反映寫程式碼的人
- **程式碼審查的回顧**:
    - 開放溝通、及時回饋、共同承諾
    - 提升開發流程
    - 建立相互學習與尊重的文化

---

# 結論：協作的本質

- **協作本質**超越技術層面：
    - 共享願景
    - 擁抱多元視角
    - 培養環境讓每個成員感到被重視與傾聽
- 本章基於經驗分享，旨在助您成為更優秀的 Flutter 工程師